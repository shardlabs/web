# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Shard is a marketing/documentation website for the Shard product - a data workspace combining SQLite databases with a modern visual interface for managing tables, creating automations, and building charts. This repository contains the static documentation and landing site built with Astro.

The main product application is hosted at `https://app.shard.sh`, while this repo hosts `https://shard.sh`.

## Development Commands

```bash
# Start development server
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview
```

## Tech Stack

- **Framework**: Astro 5.x with static output
- **Integrations**:
  - `@astrojs/starlight` - Documentation framework
  - `@astrojs/react` - For React islands/components
  - `@astrojs/mdx` - MDX content support
- **Content**: MDX files with Astro's content collections
- **Styling**: Scoped CSS within Astro components (no external CSS framework)

## Architecture

### Site Structure

The site has two main sections:

1. **Landing Page** (`/`) - Marketing homepage with hero, pricing, and workflow visualization
2. **Documentation** (`/docs/*`) - Starlight-powered documentation site

### Content Collections

Defined in `src/content.config.ts`:

- **`blog`** collection: Blog posts (currently minimal, one example post)
  - Schema: title, description, date, draft flag
  - Located in `src/content/blog/`

- **`docs`** collection: Documentation pages managed by Starlight
  - Uses Starlight's docsLoader and docsSchema
  - Located in `src/content/docs/docs/`
  - Organized into subdirectories: `using-shard/`, `billing/`, `policy/`

### Key Pages & Components

**Pages** (`src/pages/`):
- `index.astro` - Landing page with hero, pricing section, footer
- `404.astro` - Custom 404 page
- `blog/[slug].astro` - Blog post template
- `blog/index.astro` - Blog listing page
- `js/script.js.js` - Client-side JavaScript file

**Components** (`src/components/`):
- `WorkflowVisualization.astro` - Animated workflow demo showing form → table → automation flow with mock data
- `PricingTable.astro` - Pricing cards with early access overlay (3 tiers: Free, Personal, Pro)

**Layouts** (`src/layouts/`):
- `LandingLayout.astro` - Base layout for landing page

### Starlight Configuration

The `astro.config.mjs` configures Starlight with:
- Site URL: `https://shard.sh`
- Title: "Shard Docs"
- Logo: `./src/assets/icon.svg`
- Custom sidebar structure with autogenerated sections
- Disabled 404 route (custom 404 page used instead)

### Cloudflare Pages Integration

**Functions** (`functions/api/`):
- `events.js` - Cloudflare Pages Function that proxies POST requests to `https://datafa.st/api/events`
  - Forwards User-Agent and Origin headers
  - Used for analytics/event tracking without exposing backend directly

This site is deployed as a static site to Cloudflare Pages with an API function for event tracking.

## Content Structure

Documentation is organized hierarchically:
- Start Here (`docs/index.mdx`)
- Using Shard (`docs/using-shard/`)
  - tables.mdx
  - automations.mdx
  - charts.mdx
  - export.mdx
- Billing (`docs/billing/billing.mdx`)
- Policy (`docs/policy/`)
  - terms.mdx
  - privacy.mdx

## Key Implementation Details

### Pricing Display
All pricing tiers are overlaid with an "Free During Early Access" message (see `PricingTable.astro`). The overlay is responsive and hides the underlying pricing cards on mobile.

### Workflow Visualization
The `WorkflowVisualization.astro` component runs an automated demo cycle:
1. Shows form being filled with mock data
2. Displays entry being added to table
3. Triggers automation notification for companies > 500 employees
4. Uses data-driven animations with TypeScript interfaces for type safety

### Styling Approach
All styles are scoped within component `<style>` blocks. Extensive use of:
- CSS custom properties and nested selectors
- rgba colors with transparency for glassmorphic effects
- Linear gradients for text and backgrounds
- Responsive breakpoints at 768px, 1024px, 1100px, 1500px

### TypeScript Configuration
- Extends Astro's strict tsconfig
- JSX configured for React with `react-jsx` transform
- Excludes `dist/` directory from compilation
